5/13 필기

오늘 실습은 adc를 쓴다

ADC analog to digital converter 

- adc를 할때 하는것 2가지

양자화 y 축을 기준으로 데이터의 크기(전압 등)을 좀더 세부적으로 - 정보의 구체화

샘플링 x축을 기준으로(시간 t) 많이하면 데이터를 좀더 자세하게 - 정보의 대량화



실습시작

저번시간꺼 복시

헤더파일 수정

![헤더파일 수정](C:\Users\성한\Desktop\임베디드시스템설계실험\5.13수업\헤더파일 수정.PNG)

adc 레지스터 사용하기위해 설정

1 구조체 설정 2 define 3 메인에 함수 정의

컨트롤 v로 블록 하고 y로 복사 복사

메인에도 선언

void set_acd1() 만들음

adc1_sqr1 => adc안에서도 채널이 여러개존재하는데 한개만 쓸거고 한번의 변환만 할것을 의미함 

adc1_sqr3 -> 첫번째 변환

nvic에 인터럽트 사용하는것 쓰기

adc1 interrupt는 18번째에있음

함수 main에 선언하고 adc를 사용하기위한 setup과정 끝

아두이노프로그램 다운

adc1_irqhandler사용

sr레지스터로 사용가능한지 확인 (변환이 완료 되었는지) 변환이 완료되면 인터럽트가  발생한다. 그때 dr레지스터를 읽어보면 됨

1로  & 마스킹하는게 status레지스터로서 상태를 나타내는건데 거기 담긴  1번째 비트가 1이면 adc 인터럽트로 간주하고 사용하면됨 밑에보면 EOC를 확인하는거

![1로 &해서 SR을 확인하는부분](C:\Users\성한\Desktop\임베디드시스템설계실험\5.13수업\1로 &해서 SR을 확인하는부분.PNG)

dr레지스터는 하드웨어 주소를 가리키며 데이터 담김

8비트만 볼거니까 나머지는 비트마스킹

sprintf() 함수 사용

sprintf는 문자열 길이를 반환함 즉 받은 것을 문자열로 변환함

임베디드시스템에서는 웬만하면 std라이브러리 안쓰는게좋음

바이너리가 커지기때문에

스타트업에 인터럽트 선언해줘야함 ADC IRQ Handler

스탠다드쓸때 링킹할때 특수한 옵션을 넣어줘야함



링커스크립트 수정 함

malloc할때 힙을 잡는것처럼 heap을 세팅해줘야함



flash하고 gtk 보면 전압 출렁거림

아두이노 tools port ttyUSB0 체크

실습 끝



과제 나갈건데 

#stdio.h 쓰지말고 

똑같이 구현해보기

adc핸들러에서 sprintf도 못씀 

adc했던 과정 리포트

#stdio.h 과정 리포트

main.c 만 만지면 됨

비트 에 48 씩 더해서 아스키코드화 해버리자 그냥 